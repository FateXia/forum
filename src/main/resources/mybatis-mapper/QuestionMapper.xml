<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nchu.mapper.QuestionMapper" >
  <resultMap id="BaseResultMap" type="com.nchu.domain.DO.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="question_id" property="questionId" jdbcType="BIGINT" />
    <result column="bad_num" property="badNum" jdbcType="BIGINT" />
    <result column="content" property="content" jdbcType="VARCHAR" />
    <result column="course_id" property="courseId" jdbcType="BIGINT" />
    <result column="good_num" property="goodNum" jdbcType="BIGINT" />
    <result column="is_cream" property="isCream" jdbcType="BIT" />
    <result column="is_resource" property="isResource" jdbcType="BIT" />
    <result column="level" property="level" jdbcType="BIGINT" />
    <result column="level_desc" property="levelDesc" jdbcType="VARCHAR" />
    <result column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="person_name" property="personName" jdbcType="VARCHAR" />
    <result column="question_desc" property="questionDesc" jdbcType="VARCHAR" />
    <result column="techer_id" property="techerId" jdbcType="BIGINT" />
    <result column="techer_name" property="techerName" jdbcType="VARCHAR" />
    <result column="time" property="time" jdbcType="TIMESTAMP" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="visit_num" property="visitNum" jdbcType="BIGINT" />
    <result column="course_name" property="courseName" jdbcType="VARCHAR" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from question
    where question_id = #{questionId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.nchu.domain.DO.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Long" keyProperty="questionId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into question (bad_num, content, course_id,
      good_num, is_cream, is_resource,
      `level`, level_desc, person_id,
      person_name, question_desc, techer_id,
      techer_name, `time`, title,
      visit_num, course_name)
    values (#{badNum,jdbcType=BIGINT}, #{content,jdbcType=VARCHAR}, #{courseId,jdbcType=BIGINT},
      #{goodNum,jdbcType=BIGINT}, #{isCream,jdbcType=BIT}, #{isResource,jdbcType=BIT},
      #{level,jdbcType=BIGINT}, #{levelDesc,jdbcType=VARCHAR}, #{personId,jdbcType=BIGINT},
      #{personName,jdbcType=VARCHAR}, #{questionDesc,jdbcType=VARCHAR}, #{techerId,jdbcType=BIGINT},
      #{techerName,jdbcType=VARCHAR}, #{time,jdbcType=TIMESTAMP}, #{title,jdbcType=VARCHAR},
      #{visitNum,jdbcType=BIGINT}, #{courseName,jdbcType=VARCHAR})
  </insert>


  <insert id="insertSelective" parameterType="com.nchu.domain.DO.Question" useGeneratedKeys="true" keyProperty="questionId">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Long" keyProperty="questionId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into question (content, course_id,
    `level`, level_desc, person_id,
    person_name, question_desc, techer_id,
    techer_name, title, course_name, `time`)
    values ( #{content,jdbcType=VARCHAR}, #{courseId,jdbcType=BIGINT},
    #{level,jdbcType=BIGINT}, #{levelDesc,jdbcType=VARCHAR}, #{personId,jdbcType=BIGINT},
    #{personName,jdbcType=VARCHAR}, #{questionDesc,jdbcType=VARCHAR}, #{techerId,jdbcType=BIGINT},
    #{techerName,jdbcType=VARCHAR}, #{title,jdbcType=VARCHAR},
    #{courseName,jdbcType=VARCHAR}, #{time,jdbcType=TIMESTAMP})


  </insert>
  <update id="updateContent" parameterType="com.nchu.domain.DO.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update question
    set
    content = #{content,jdbcType=VARCHAR},
    course_id = #{courseId,jdbcType=BIGINT},
    `level` = #{level,jdbcType=BIGINT},
    level_desc = #{levelDesc,jdbcType=VARCHAR},
    question_desc = #{questionDesc,jdbcType=VARCHAR},
    title = #{title,jdbcType=VARCHAR},
    course_name = #{courseName,jdbcType=VARCHAR}
    where question_id = #{questionId,jdbcType=BIGINT}
  </update>



  <update id="updateGoodOrBad">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update question  set
    <if test="key==1">
    good_num=#{goodNum,jdbcType=BIGINT}
    </if>

    <if test="key==0">
      bad_num=#{badNum,jdbcType=BIGINT}
    </if>

    where question_id = #{questionId,jdbcType=BIGINT}
  </update>

    <update id="updateCream" parameterType="com.nchu.domain.DO.Question" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update question
        set
        is_cream = #{isCream,jdbcType=BIT}
        where question_id = #{questionId,jdbcType=BIGINT}
    </update>


  <update id="updateVisit" parameterType="com.nchu.domain.DO.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update question
    set
    visit_num = #{visitNum,jdbcType=BIT}
    where question_id = #{questionId,jdbcType=BIGINT}
  </update>

  <update id="updateByPrimaryKey" parameterType="com.nchu.domain.DO.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update question
    set
      is_resource = #{isResource,jdbcType=BIT},
      question_desc = #{questionDesc,jdbcType=VARCHAR},
      techer_id = #{techerId,jdbcType=BIGINT},
      techer_name = #{techerName,jdbcType=VARCHAR}
    where question_id = #{questionId,jdbcType=BIGINT}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream, is_resource, 
    `level`, level_desc, person_id, person_name, question_desc, techer_id, techer_name, 
    `time`, title, visit_num, course_name
    from question
    where question_id = #{questionId,jdbcType=BIGINT}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream, is_resource, 
    `level`, level_desc, person_id, person_name, question_desc, techer_id, techer_name, 
    `time`, title, visit_num, course_name
    from question
  </select>

  <select id="isCreamQuetion" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream, is_resource,
    `level`, level_desc, person_id, person_name, question_desc, techer_id, techer_name,
    `time`, title, visit_num, course_name
    from question WHERE is_cream=1 ORDER BY question_id DESC
    <if test="pageSize!=null and currentPage!=null" >
      limit  #{currentPage},#{pageSize}
    </if>

  </select>

  <select id="isCreamQuetionbyCourseId" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream, is_resource,
    `level`, level_desc, person_id, person_name, question_desc, techer_id, techer_name,
    `time`, title, visit_num, course_name
    from question WHERE is_cream=1 AND course_id=#{courseId} ORDER BY question_id DESC
    <if test="pageSize!=null and currentPage!=null" >
      limit  #{currentPage},#{pageSize}
    </if>

  </select>


  <select id="isCreamQuetionCount" resultType="integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(1)
    from question WHERE is_cream=1;
  </select>

  <select id="isCreamQuetionCountbyCourseId" resultType="integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(1)
    from question WHERE is_cream=1 AND course_id=#{courseId};
  </select>


  <select id="newQuetionAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream, is_resource,
    `level`, level_desc, person_id, person_name, question_desc, techer_id, techer_name,
    `time`, title, visit_num, course_name
    from question  ORDER BY visit_num DESC
    <if test="pageSize!=null and currentPage!=null" >
      limit  #{currentPage},#{pageSize}
    </if>

  </select>

  <select id="newQuetionAllCount" resultType="integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(1)
    from question ;
  </select>





  <select id="selectQuestionList" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream,
    is_resource, `level`, level_desc, person_id, person_name, question_desc, techer_id,
    techer_name,course_name, `time`, title, visit_num
    from question WHERE 1=1

    <if test="courseId!=null">
      and  course_id=#{courseId,jdbcType=BIGINT}
    </if>

    <if test="level!=null">
      and  `level`=#{level,jdbcType=BIGINT}
    </if>

    <if test="pageSize!=null and currentPage!=null" >
      limit  #{currentPage},#{pageSize}
    </if>


  </select>

  <select id="selectCountQuestion" resultType="Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(1)
    from question WHERE 1=1

    <if test="courseId!=null">
      and  course_id=#{courseId,jdbcType=BIGINT}
    </if>

    <if test="level!=null">
      and  `level`=#{level,jdbcType=BIGINT}
    </if>



  </select>




  <select id="questionSearcher" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select question_id, bad_num, content, course_id, good_num, is_cream,
    is_resource, `level`, level_desc, person_id, person_name, question_desc, techer_id,
    techer_name,course_name, `time`, title, visit_num
    from question
    WHERE  title LIKE  '%${key}%'
    OR person_name LIKE '%${key}%'
    OR techer_name LIKE '%${key}%'

    <if test="pageSize!=null and currentPage!=null" >
      limit  #{currentPage},#{pageSize}
    </if>

  </select>

  <select id="selectCountQuestionForKey" resultType="Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(1)
    from question
    WHERE  title LIKE  '%${key}%'
    OR person_name LIKE '%${key}%'
    OR techer_name LIKE '%${key}%'


  </select>

</mapper>